version: '3.8'

services:
  ksef-monitor:
    image: ghcr.io/mlotocki2k/ksef_monitor:latest
    container_name: ksef-invoice-monitor
    restart: unless-stopped

    # Use .env file for secrets (recommended for development)
    # .env should contain: KSEF_TOKEN, PUSHOVER_*, DISCORD_WEBHOOK_URL,
    # SLACK_WEBHOOK_URL, EMAIL_PASSWORD, WEBHOOK_TOKEN
    # See examples/.env.example for template
    env_file:
      - .env

    ports:
      # Prometheus metrics endpoint
      - "8000:8000"

    volumes:
      # Configuration file (non-sensitive settings only)
      # Use config.secure.json which doesn't contain tokens
      - ./config.secure.json:/data/config.json:ro
      
      # Persistent storage for tracking seen invoices
      - ./data:/data

      # Uncomment to use custom notification templates (Jinja2)
      # - ./templates:/data/templates:ro
    
    # Uncomment for debugging
    # logging:
    #   driver: "json-file"
    #   options:
    #     max-size: "10m"
    #     max-file: "3"
